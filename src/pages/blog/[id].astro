---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";
import { Image } from "astro:assets";
import { identity } from "../../config";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content, remarkPluginFrontmatter } = await render(post);
---

<Layout
  seo={{
    title: post.data.title,
    description: post.data.description,
    image: post.data.image.url,
  }}
>
  <section class="mt-10 max-w-2xl mx-auto px-6">
    <h1 class="font-bold text-3xl mb-4 text-[#1a1a1a]">{post.data.title}</h1>
    <p class="opacity-60 mb-6 text-[#1a1a1a]">
      {post.data.description}
    </p>
    <div class="flex gap-4 mb-6">
      <div>
        <p class="font-medium text-[#1a1a1a]">{identity.name}</p>
        <p class="opacity-60 text-[#1a1a1a]">
          {post.data.pubDate.toLocaleDateString()} Â· {
            remarkPluginFrontmatter.minutesRead
          }
        </p>
      </div>
    </div>
    <Image
      src={post.data.image.url}
      alt={post.data.image.alt}
      width={800}
      height={300}
      class="apsect-video w-full rounded-xl mb-10"
    />
    <article class="blog-content prose max-w-none">
      <Content />
    </article>
  </section>
</Layout>

<style is:global>
  article.blog-content {
    color: #111111;
    --tw-prose-body: #111111;
    --tw-prose-headings: #111111;
    --tw-prose-bold: #111111;
    --tw-prose-counters: #4b5563;
    --tw-prose-bullets: #4b5563;
    --tw-prose-quotes: #111111;
    --tw-prose-quote-borders: #d1d5db;
    --tw-prose-hr: #e5e7eb;
    --tw-prose-links: #1d4ed8;
    --tw-prose-th-borders: #d1d5db;
    --tw-prose-td-borders: #e5e7eb;
    --tw-prose-code: #111111;
    --tw-prose-pre-code: #e5e7eb;
    --tw-prose-pre-bg: #0f172a;
  }

  article.blog-content h1,
  article.blog-content h2,
  article.blog-content h3,
  article.blog-content h4,
  article.blog-content h5,
  article.blog-content h6,
  article.blog-content p,
  article.blog-content li,
  article.blog-content span,
  article.blog-content td,
  article.blog-content th,
  article.blog-content em,
  article.blog-content i,
  article.blog-content strong,
  article.blog-content b {
    color: #111111;
  }

  article.blog-content a {
    color: #1d4ed8;
  }

  article.blog-content a:hover {
    color: #1e3a8a;
  }

  article.blog-content code:not(pre code) {
    color: #111111;
    background-color: #f3f4f6;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.9em;
  }

  article.blog-content pre {
    background-color: #0f172a;
    border: 1px solid #1e293b;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    color: #f8fafc;
  }

  article.blog-content pre code {
    color: inherit;
    background-color: transparent;
    padding: 0;
  }

  article.blog-content blockquote {
    color: #1f2937;
    border-left-color: #d1d5db;
  }

  article.blog-content thead {
    color: #111111;
  }
</style>
